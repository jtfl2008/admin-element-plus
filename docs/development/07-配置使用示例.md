# 配置使用示例

## 概述

本文档提供项目中各项配置的实际使用示例。

## 一、环境变量使用

### 1.1 在组件中使用

```vue
<script setup lang="ts">
import ENV_CONFIG from '@/config/env'

// 直接使用
console.log('应用标题:', ENV_CONFIG.APP_TITLE)
console.log('API 地址:', ENV_CONFIG.BASE_API)
console.log('当前环境:', ENV_CONFIG.MODE)
console.log('是否开发环境:', ENV_CONFIG.isDev)

// 或者直接使用 import.meta.env
const apiUrl = import.meta.env.VITE_APP_BASE_API
</script>

<template>
  <div>
    <h1>{{ ENV_CONFIG.APP_TITLE }}</h1>
    <p>当前环境: {{ ENV_CONFIG.MODE }}</p>
  </div>
</template>
```

### 1.2 在路由配置中使用

```typescript
// src/router/index.ts
import ENV_CONFIG from '@/config/env'

// 根据环境设置不同的路由行为
const router = createRouter({
  history: createWebHistory(ENV_CONFIG.BASE_URL),
  routes: [
    // ...
  ],
})

// 开发环境启用路由日志
if (ENV_CONFIG.isDev) {
  router.beforeEach((to, from) => {
    console.log('路由跳转:', from.path, '->', to.path)
  })
}
```

## 二、API 请求使用

### 2.1 基础请求

```typescript
// src/service/api/user.ts
import { request } from '@/service/request'

export interface User {
  id: number
  name: string
  email: string
}

export interface LoginParams {
  username: string
  password: string
}

// GET 请求
export function getUserList() {
  return request.get<User[]>('/users')
}

// POST 请求
export function login(data: LoginParams) {
  return request.post('/auth/login', data)
}

// PUT 请求
export function updateUser(id: number, data: Partial<User>) {
  return request.put(`/users/${id}`, data)
}

// DELETE 请求
export function deleteUser(id: number) {
  return request.delete(`/users/${id}`)
}
```

### 2.2 在组件中使用

```vue
<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { getUserList, type User } from '@/service/api/user'

const users = ref<User[]>([])
const loading = ref(false)

const fetchUsers = async () => {
  loading.value = true
  try {
    users.value = await getUserList()
  } catch (error) {
    console.error('获取用户列表失败:', error)
  } finally {
    loading.value = false
  }
}

onMounted(() => {
  fetchUsers()
})
</script>

<template>
  <div>
    <div v-if="loading">加载中...</div>
    <ul v-else>
      <li v-for="user in users" :key="user.id">
        {{ user.name }} - {{ user.email }}
      </li>
    </ul>
  </div>
</template>
```

## 三、路径别名使用

### 3.1 导入组件

```typescript
// 使用 @ 别名
import MyComponent from '@/components/MyComponent.vue'
import { formatDate } from '@/utils/date'
import { useUserStore } from '@/stores/user'
import type { User } from '@/typings/user'

// 不使用别名（不推荐）
import MyComponent from '../../../components/MyComponent.vue'
```

### 3.2 在 CSS 中使用

```vue
<style scoped>
.logo {
  /* 使用 @ 别名引用图片 */
  background-image: url('@/assets/images/logo.png');
}
</style>
```

## 四、代理配置使用

### 4.1 开发环境代理

配置已在 `vite.config.ts` 中设置：

```typescript
// 前端请求
fetch('/api/users')  // 实际请求: http://localhost:3000/users

fetch('/upload/avatar')  // 实际请求: http://localhost:3000/upload/avatar
```

### 4.2 API 请求示例

```typescript
// src/service/request.ts 中已配置 baseURL
// 所有请求会自动添加 /api 前缀

// 请求示例
request.get('/users')  // 实际请求: /api/users -> http://localhost:3000/users
```

## 五、自动导入使用（需安装插件）

### 5.1 Vue API 自动导入

```vue
<script setup lang="ts">
// 无需手动导入，直接使用
// import { ref, computed, onMounted } from 'vue'

const count = ref(0)
const double = computed(() => count.value * 2)

onMounted(() => {
  console.log('组件已挂载')
})
</script>
```

### 5.2 组件自动导入

```vue
<script setup lang="ts">
// 无需手动导入组件
// import MyButton from '@/components/MyButton.vue'
</script>

<template>
  <!-- 直接使用，组件会自动导入 -->
  <MyButton>点击我</MyButton>
</template>
```

### 5.3 Router 和 Store 自动导入

```vue
<script setup lang="ts">
// 无需手动导入
// import { useRouter } from 'vue-router'
// import { useUserStore } from '@/stores/user'

const router = useRouter()
const userStore = useUserStore()

const goToHome = () => {
  router.push('/')
}
</script>
```

## 六、Element Plus 使用（需安装）

### 6.1 组件自动导入

```vue
<script setup lang="ts">
// 无需手动导入 Element Plus 组件
// import { ElButton, ElMessage } from 'element-plus'

const handleClick = () => {
  ElMessage.success('操作成功')
}
</script>

<template>
  <div>
    <!-- 直接使用 Element Plus 组件 -->
    <el-button type="primary" @click="handleClick">
      点击我
    </el-button>
    
    <el-input v-model="value" placeholder="请输入内容" />
    
    <el-table :data="tableData">
      <el-table-column prop="name" label="姓名" />
      <el-table-column prop="age" label="年龄" />
    </el-table>
  </div>
</template>
```

## 七、构建优化效果

### 7.1 代码分割

构建后的文件结构：

```
dist/
├── index.html
├── assets/
│   ├── css/
│   │   └── index-[hash].css
│   └── images/
│       └── logo-[hash].png
└── js/
    ├── index-[hash].js          # 入口文件
    ├── vue-[hash].js            # Vue 相关库
    ├── element-plus-[hash].js   # Element Plus（如果使用）
    └── vendor-[hash].js         # 其他第三方库
```

### 7.2 Gzip 压缩（需安装插件）

构建后会生成 `.gz` 文件：

```
dist/
└── js/
    ├── index-[hash].js
    ├── index-[hash].js.gz       # Gzip 压缩文件
    ├── vue-[hash].js
    └── vue-[hash].js.gz
```

## 八、开发调试

### 8.1 查看环境变量

```typescript
// 在任意组件中
console.log('所有环境变量:', import.meta.env)
console.log('当前模式:', import.meta.env.MODE)
console.log('是否开发环境:', import.meta.env.DEV)
console.log('是否生产环境:', import.meta.env.PROD)
```

### 8.2 Vue DevTools

项目已配置 `vite-plugin-vue-devtools`，开发环境会自动启用。

### 8.3 HMR 热更新

修改代码后会自动刷新，无需手动刷新浏览器。

## 九、生产构建

### 9.1 构建命令

```bash
# 构建生产版本
npm run build:prod

# 预览构建结果
npm run preview
```

### 9.2 构建优化

生产构建会自动：
- 移除 console 和 debugger
- 压缩代码
- 代码分割
- 生成哈希文件名（利用浏览器缓存）
- CSS 代码分割

## 十、常见使用场景

### 10.1 根据环境显示不同内容

```vue
<script setup lang="ts">
import ENV_CONFIG from '@/config/env'
</script>

<template>
  <div>
    <!-- 开发环境显示调试信息 -->
    <div v-if="ENV_CONFIG.isDev" class="debug-info">
      <p>当前环境: {{ ENV_CONFIG.MODE }}</p>
      <p>API 地址: {{ ENV_CONFIG.BASE_API }}</p>
    </div>
    
    <!-- 生产环境隐藏 -->
    <button v-if="!ENV_CONFIG.isProd" @click="testApi">
      测试 API
    </button>
  </div>
</template>
```

### 10.2 动态设置页面标题

```typescript
// src/router/index.ts
import ENV_CONFIG from '@/config/env'

router.afterEach((to) => {
  document.title = `${to.meta.title || ''} - ${ENV_CONFIG.APP_TITLE}`
})
```

### 10.3 文件上传

```vue
<script setup lang="ts">
import ENV_CONFIG from '@/config/env'

const uploadUrl = `${ENV_CONFIG.UPLOAD_URL}/avatar`

const handleUpload = async (file: File) => {
  const formData = new FormData()
  formData.append('file', file)
  
  const response = await fetch(uploadUrl, {
    method: 'POST',
    body: formData,
  })
  
  return response.json()
}
</script>
```

## 十一、最佳实践

1. **统一使用环境变量配置**：不要在代码中硬编码 URL 和配置
2. **使用路径别名**：提高代码可读性和可维护性
3. **封装 API 请求**：统一管理接口，便于维护
4. **合理使用自动导入**：减少重复代码，但注意不要过度依赖
5. **开发环境调试**：充分利用 Vue DevTools 和浏览器开发工具
6. **生产构建优化**：定期检查构建产物大小，优化性能

## 十二、参考资源

- [Vite 环境变量文档](https://vitejs.dev/guide/env-and-mode.html)
- [Vue 3 组合式 API](https://vuejs.org/guide/extras/composition-api-faq.html)
- [Element Plus 文档](https://element-plus.org/)
