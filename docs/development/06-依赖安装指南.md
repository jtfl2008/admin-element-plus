# 依赖安装指南

## 概述

本文档说明项目中各个功能模块所需的依赖包及其安装命令。所有配置都在 `vite.config.ts` 文件中，安装依赖后取消对应的注释即可启用。

## 一、必备依赖

项目已安装的基础依赖：

```json
{
  "dependencies": {
    "pinia": "^3.0.4",
    "vue": "^3.5.25",
    "vue-router": "^4.6.3"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^6.0.2",
    "@vitejs/plugin-vue-jsx": "^5.1.2",
    "vite": "^7.2.4",
    "vite-plugin-vue-devtools": "^8.0.5",
    "vue-tsc": "^3.1.5",
    "typescript": "~5.9.0"
  }
}
```

## 二、可选功能依赖

### 2.1 HTTP 请求库

用于 API 请求封装（`src/service/request.ts`）：

```bash
npm install axios
```

### 2.2 自动导入插件

自动导入 Vue API 和组件，减少重复的 import 语句：

```bash
npm install -D unplugin-auto-import unplugin-vue-components
```

**启用方式：**

在 `vite.config.ts` 中取消以下注释：

```typescript
// 1. 取消导入注释
import AutoImport from 'unplugin-auto-import/vite'
import Components from 'unplugin-vue-components/vite'

// 2. 取消插件配置注释
AutoImport({
  imports: ['vue', 'vue-router', 'pinia'],
  dts: 'src/auto-imports.d.ts',
  eslintrc: {
    enabled: true,
    filepath: './.eslintrc-auto-import.json',
  },
}),

Components({
  dts: 'src/components.d.ts',
  dirs: ['src/components'],
  extensions: ['vue'],
  deep: true,
}),
```

### 2.3 Element Plus UI 组件库

企业级 UI 组件库及按需导入：

```bash
# 安装 Element Plus
npm install element-plus

# 安装自动导入插件（如果未安装）
npm install -D unplugin-auto-import unplugin-vue-components
```

**启用方式：**

在 `vite.config.ts` 中：

```typescript
// 1. 取消导入注释
import { ElementPlusResolver } from 'unplugin-vue-components/resolvers'

// 2. 在 AutoImport 和 Components 中添加 resolver
AutoImport({
  imports: ['vue', 'vue-router', 'pinia'],
  resolvers: [ElementPlusResolver()], // 添加这行
  dts: 'src/auto-imports.d.ts',
  eslintrc: {
    enabled: true,
    filepath: './.eslintrc-auto-import.json',
  },
}),

Components({
  resolvers: [ElementPlusResolver()], // 添加这行
  dts: 'src/components.d.ts',
  dirs: ['src/components'],
  extensions: ['vue'],
  deep: true,
}),

// 3. 在 build.rollupOptions.output.manualChunks 中添加
manualChunks: {
  vue: ['vue', 'vue-router', 'pinia'],
  'element-plus': ['element-plus'], // 添加这行
},

// 4. 在 optimizeDeps.include 中添加
include: ['vue', 'vue-router', 'pinia', 'element-plus'], // 添加 element-plus
```

### 2.4 Gzip 压缩插件

生产环境打包时压缩文件：

```bash
npm install -D vite-plugin-compression
```

**启用方式：**

在 `vite.config.ts` 中取消以下注释：

```typescript
// 1. 取消导入注释
import viteCompression from 'vite-plugin-compression'

// 2. 取消插件配置注释
viteCompression({
  verbose: true,
  disable: false,
  threshold: 10240, // 大于 10KB 的文件进行压缩
  algorithm: 'gzip',
  ext: '.gz',
}),
```

### 2.5 SVG 图标插件

SVG 图标管理和使用：

```bash
npm install -D vite-plugin-svg-icons
```

**启用方式：**

在 `vite.config.ts` 中取消以下注释：

```typescript
// 1. 取消导入注释
import { createSvgIconsPlugin } from 'vite-plugin-svg-icons'

// 2. 取消插件配置注释
createSvgIconsPlugin({
  iconDirs: [path.resolve(process.cwd(), 'src/assets/icons')],
  symbolId: 'icon-[dir]-[name]',
}),
```

然后创建 `src/assets/icons` 目录存放 SVG 图标。

### 2.6 常用工具库

```bash
# 日期处理
npm install dayjs

# 工具函数库
npm install lodash-es
npm install -D @types/lodash-es

# VueUse 工具集
npm install @vueuse/core
```

## 三、推荐安装顺序

### 3.1 基础开发环境

```bash
# 1. HTTP 请求库
npm install axios

# 2. 常用工具库
npm install dayjs lodash-es @vueuse/core
npm install -D @types/lodash-es
```

### 3.2 自动导入功能

```bash
# 安装自动导入插件
npm install -D unplugin-auto-import unplugin-vue-components

# 然后在 vite.config.ts 中取消对应注释
```

### 3.3 UI 组件库

```bash
# 安装 Element Plus
npm install element-plus

# 然后在 vite.config.ts 中取消对应注释
```

### 3.4 生产优化

```bash
# 安装压缩插件
npm install -D vite-plugin-compression

# 然后在 vite.config.ts 中取消对应注释
```

## 四、验证安装

安装完依赖后，运行以下命令验证：

```bash
# 开发环境
npm run dev

# 类型检查
npm run type-check

# 构建生产版本
npm run build:prod
```

## 五、注意事项

1. **配置文件**：所有配置都在 `vite.config.ts` 中，通过注释/取消注释来启用功能
2. **依赖版本**：建议使用文档中指定的版本，避免兼容性问题
3. **自动生成文件**：使用自动导入插件后会生成以下文件（已加入 .gitignore）：
   - `src/auto-imports.d.ts`
   - `src/components.d.ts`
   - `.eslintrc-auto-import.json`
4. **环境变量**：确保 `.env.development` 和 `.env.production` 文件已正确配置
5. **重启服务**：修改 `vite.config.ts` 后需要重启开发服务器

## 六、常见问题

### Q1: 自动导入不生效？

A: 确保已安装 `unplugin-auto-import` 和 `unplugin-vue-components`，并在 `vite.config.ts` 中取消了对应注释，然后重启开发服务器。

### Q2: Element Plus 样式丢失？

A: 使用自动导入配置时，样式会自动导入。确保在 `AutoImport` 和 `Components` 中都添加了 `ElementPlusResolver()`。

### Q3: 打包后文件过大？

A: 启用 Gzip 压缩插件，或检查代码分割配置。

## 七、参考资源

- [Vite 官方文档](https://vitejs.dev/)
- [Element Plus 官方文档](https://element-plus.org/)
- [unplugin-auto-import](https://github.com/antfu/unplugin-auto-import)
- [unplugin-vue-components](https://github.com/antfu/unplugin-vue-components)
