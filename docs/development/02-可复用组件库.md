# 可复用组件库

## 组件分类

项目中的组件分为三大类：

1. **通用组件 (common)**: 基础 UI 组件
2. **高级组件 (advanced)**: 复杂业务组件
3. **自定义组件 (custom)**: 业务定制组件

## 通用组件 (Common Components)

### 1. AppProvider - 应用提供者

全局配置提供者，用于配置主题、国际化等。

```vue
<template>
  <AppProvider>
    <RouterView />
  </AppProvider>
</template>
```

### 2. SystemLogo - 系统 Logo

显示系统 Logo 和标题。

```vue
<template>
  <SystemLogo />
</template>
```

**Props**:
- `show-title`: 是否显示标题，默认 `true`

### 3. DarkModeContainer - 暗黑模式容器

提供暗黑模式适配的容器组件。

```vue
<template>
  <DarkModeContainer>
    <div>内容</div>
  </DarkModeContainer>
</template>
```

### 4. FullScreen - 全屏切换

全屏显示切换按钮。

```vue
<template>
  <FullScreen />
</template>
```

### 5. LangSwitch - 语言切换

多语言切换组件。

```vue
<template>
  <LangSwitch />
</template>
```

### 6. ThemeSchemaSwitch - 主题模式切换

明暗主题切换组件。

```vue
<template>
  <ThemeSchemaSwitch />
</template>
```

### 7. MenuToggler - 菜单切换

侧边栏菜单展开/收起按钮。

```vue
<template>
  <MenuToggler />
</template>
```

### 8. ReloadButton - 刷新按钮

页面刷新按钮。

```vue
<template>
  <ReloadButton />
</template>
```

### 9. IconTooltip - 图标提示

带提示的图标组件。

```vue
<template>
  <IconTooltip icon="mdi:help-circle" tooltip="帮助信息" />
</template>
```

**Props**:
- `icon`: 图标名称（Iconify）
- `tooltip`: 提示文本
- `placement`: 提示位置，默认 `'top'`

### 10. ExceptionBase - 异常页面基础组件

用于 403、404、500 等异常页面。

```vue
<template>
  <ExceptionBase
    type="404"
    title="页面不存在"
    description="抱歉，您访问的页面不存在"
  />
</template>
```

**Props**:
- `type`: 异常类型 `'403' | '404' | '500'`
- `title`: 标题
- `description`: 描述

## 高级组件 (Advanced Components)

### 1. TableColumnSetting - 表格列设置

表格列显示/隐藏配置组件。

```vue
<script setup lang="ts">
import { ref } from 'vue';
import TableColumnSetting from '@/components/advanced/table-column-setting.vue';

const columns = ref([
  { prop: 'id', label: 'ID', visible: true },
  { prop: 'name', label: '名称', visible: true },
  { prop: 'status', label: '状态', visible: true }
]);
</script>

<template>
  <TableColumnSetting v-model:columns="columns" />
</template>
```

**Props**:
- `columns`: 列配置数组

**Events**:
- `update:columns`: 列配置更新事件

### 2. TableHeaderOperation - 表格头部操作

表格头部操作栏组件。

```vue
<template>
  <TableHeaderOperation
    :loading="loading"
    @refresh="handleRefresh"
    @add="handleAdd"
  >
    <template #extra>
      <el-button>自定义按钮</el-button>
    </template>
  </TableHeaderOperation>
</template>
```

**Props**:
- `loading`: 加载状态
- `show-add`: 是否显示新增按钮，默认 `true`
- `show-refresh`: 是否显示刷新按钮，默认 `true`

**Events**:
- `refresh`: 刷新事件
- `add`: 新增事件

**Slots**:
- `extra`: 额外操作按钮

### 3. TableRowCheckAlert - 表格行选择提示

表格批量操作提示组件。

```vue
<script setup lang="ts">
import { ref } from 'vue';

const selectedRows = ref([]);
</script>

<template>
  <TableRowCheckAlert
    :selected-count="selectedRows.length"
    @clear="selectedRows = []"
    @batch-delete="handleBatchDelete"
  />
</template>
```

**Props**:
- `selected-count`: 选中数量

**Events**:
- `clear`: 清空选择
- `batch-delete`: 批量删除

### 4. TableSiderLayout - 表格侧边栏布局

带侧边栏的表格布局组件。

```vue
<template>
  <TableSiderLayout>
    <template #sider>
      <div>侧边栏内容（如树形菜单）</div>
    </template>
    <template #default>
      <div>表格内容</div>
    </template>
  </TableSiderLayout>
</template>
```

**Props**:
- `sider-width`: 侧边栏宽度，默认 `'240px'`

**Slots**:
- `sider`: 侧边栏内容
- `default`: 主内容区

## 自定义组件 (Custom Components)

### 1. ButtonIcon - 图标按钮

带图标的按钮组件。

```vue
<template>
  <ButtonIcon icon="mdi:plus" tooltip="新增" @click="handleAdd" />
</template>
```

**Props**:
- `icon`: 图标名称
- `tooltip`: 提示文本
- `type`: 按钮类型
- `size`: 按钮大小

### 2. SvgIcon - SVG 图标

本地 SVG 图标组件。

```vue
<template>
  <SvgIcon name="menu-system" :size="24" />
</template>
```

**Props**:
- `name`: 图标名称
- `size`: 图标大小，默认 `16`
- `color`: 图标颜色

### 3. CountTo - 数字动画

数字滚动动画组件。

```vue
<template>
  <CountTo :start-value="0" :end-value="1000" :duration="2000" />
</template>
```

**Props**:
- `start-value`: 起始值，默认 `0`
- `end-value`: 结束值
- `duration`: 动画时长（毫秒），默认 `2000`
- `decimals`: 小数位数，默认 `0`
- `separator`: 千分位分隔符，默认 `','`

### 4. BooleanTag - 布尔标签

布尔值显示标签。

```vue
<template>
  <BooleanTag :value="true" />
</template>
```

**Props**:
- `value`: 布尔值
- `true-text`: true 时显示的文本，默认 `'是'`
- `false-text`: false 时显示的文本，默认 `'否'`

### 5. StatusSwitch - 状态开关

状态切换开关组件。

```vue
<template>
  <StatusSwitch
    v-model="status"
    :api="updateStatus"
    :id="row.id"
  />
</template>
```

**Props**:
- `modelValue`: 状态值
- `api`: 更新状态的 API 函数
- `id`: 记录 ID

**Events**:
- `update:modelValue`: 状态更新事件

### 6. DictSelect - 字典选择器

字典数据选择器。

```vue
<template>
  <DictSelect v-model="form.type" dict-type="sys_user_sex" />
</template>
```

**Props**:
- `modelValue`: 选中值
- `dict-type`: 字典类型
- `placeholder`: 占位文本

**Events**:
- `update:modelValue`: 值更新事件

### 7. DictTag - 字典标签

字典数据标签显示。

```vue
<template>
  <DictTag :value="row.status" dict-type="sys_normal_disable" />
</template>
```

**Props**:
- `value`: 字典值
- `dict-type`: 字典类型

### 8. DictRadio - 字典单选

字典数据单选组件。

```vue
<template>
  <DictRadio v-model="form.status" dict-type="sys_normal_disable" />
</template>
```

**Props**:
- `modelValue`: 选中值
- `dict-type`: 字典类型

**Events**:
- `update:modelValue`: 值更新事件

### 9. DictCheckbox - 字典复选

字典数据复选组件。

```vue
<template>
  <DictCheckbox v-model="form.roles" dict-type="sys_user_role" />
</template>
```

**Props**:
- `modelValue`: 选中值数组
- `dict-type`: 字典类型

**Events**:
- `update:modelValue`: 值更新事件

### 10. DeptTreeSelect - 部门树选择器

部门树形选择器。

```vue
<template>
  <DeptTreeSelect v-model="form.deptId" />
</template>
```

**Props**:
- `modelValue`: 选中的部门 ID
- `placeholder`: 占位文本

**Events**:
- `update:modelValue`: 值更新事件

### 11. DeptTree - 部门树

部门树形展示组件。

```vue
<template>
  <DeptTree @node-click="handleNodeClick" />
</template>
```

**Events**:
- `node-click`: 节点点击事件

### 12. MenuTreeSelect - 菜单树选择器

菜单树形选择器。

```vue
<template>
  <MenuTreeSelect v-model="form.parentId" />
</template>
```

**Props**:
- `modelValue`: 选中的菜单 ID
- `placeholder`: 占位文本

**Events**:
- `update:modelValue`: 值更新事件

### 13. MenuTree - 菜单树

菜单树形展示组件。

```vue
<template>
  <MenuTree @node-click="handleNodeClick" />
</template>
```

**Events**:
- `node-click`: 节点点击事件

### 14. UserSelect - 用户选择器

用户选择器组件。

```vue
<template>
  <UserSelect v-model="form.userId" />
</template>
```

**Props**:
- `modelValue`: 选中的用户 ID
- `multiple`: 是否多选，默认 `false`
- `placeholder`: 占位文本

**Events**:
- `update:modelValue`: 值更新事件

### 15. RoleSelect - 角色选择器

角色选择器组件。

```vue
<template>
  <RoleSelect v-model="form.roleIds" multiple />
</template>
```

**Props**:
- `modelValue`: 选中的角色 ID（数组）
- `multiple`: 是否多选，默认 `false`
- `placeholder`: 占位文本

**Events**:
- `update:modelValue`: 值更新事件

### 16. PostSelect - 岗位选择器

岗位选择器组件。

```vue
<template>
  <PostSelect v-model="form.postIds" multiple />
</template>
```

**Props**:
- `modelValue`: 选中的岗位 ID（数组）
- `multiple`: 是否多选，默认 `false`
- `placeholder`: 占位文本

**Events**:
- `update:modelValue`: 值更新事件

### 17. TenantSelect - 租户选择器

租户选择器组件。

```vue
<template>
  <TenantSelect v-model="form.tenantId" />
</template>
```

**Props**:
- `modelValue`: 选中的租户 ID
- `placeholder`: 占位文本

**Events**:
- `update:modelValue`: 值更新事件

### 18. FileUpload - 文件上传

文件上传组件。

```vue
<template>
  <FileUpload
    v-model="form.fileList"
    :limit="5"
    :file-size="10"
    :file-type="['jpg', 'png', 'pdf']"
  />
</template>
```

**Props**:
- `modelValue`: 文件列表
- `limit`: 文件数量限制
- `file-size`: 文件大小限制（MB）
- `file-type`: 允许的文件类型

**Events**:
- `update:modelValue`: 文件列表更新事件

### 19. OssUpload - OSS 上传

OSS 对象存储上传组件。

```vue
<template>
  <OssUpload
    v-model="form.ossId"
    :limit="1"
  />
</template>
```

**Props**:
- `modelValue`: OSS 文件 ID
- `limit`: 文件数量限制

**Events**:
- `update:modelValue`: 值更新事件

### 20. JsonPreview - JSON 预览

JSON 数据预览组件。

```vue
<template>
  <JsonPreview :data="jsonData" />
</template>
```

**Props**:
- `data`: JSON 数据对象

### 21. UmoDocEditor - 文档编辑器

富文本编辑器组件。

```vue
<template>
  <UmoDocEditor v-model="form.content" />
</template>
```

**Props**:
- `modelValue`: 编辑器内容
- `height`: 编辑器高度，默认 `'400px'`

**Events**:
- `update:modelValue`: 内容更新事件

### 22. BetterScroll - 滚动容器

优化的滚动容器组件。

```vue
<template>
  <BetterScroll :options="{ scrollbar: true }">
    <div>滚动内容</div>
  </BetterScroll>
</template>
```

**Props**:
- `options`: BetterScroll 配置选项

### 23. SoybeanAvatar - 头像组件

用户头像显示组件。

```vue
<template>
  <SoybeanAvatar :src="user.avatar" :size="48" />
</template>
```

**Props**:
- `src`: 头像地址
- `size`: 头像大小，默认 `40`
- `shape`: 头像形状 `'circle' | 'square'`，默认 `'circle'`

### 24. FormTip - 表单提示

表单项提示组件。

```vue
<template>
  <el-form-item label="用户名">
    <el-input v-model="form.username" />
    <FormTip>用户名长度为 4-20 个字符</FormTip>
  </el-form-item>
</template>
```

**Props**:
- `type`: 提示类型 `'info' | 'warning' | 'error'`，默认 `'info'`

### 25. WaveBg - 波浪背景

波浪动画背景组件。

```vue
<template>
  <WaveBg>
    <div>内容</div>
  </WaveBg>
</template>
```

## 组件使用最佳实践

### 1. 组件导入

```typescript
// 全局注册的组件可以直接使用
<template>
  <DictSelect v-model="form.type" dict-type="sys_user_sex" />
</template>

// 局部导入组件
<script setup lang="ts">
import TableColumnSetting from '@/components/advanced/table-column-setting.vue';
</script>
```

### 2. Props 传递

```vue
<template>
  <!-- 静态 props -->
  <ButtonIcon icon="mdi:plus" tooltip="新增" />
  
  <!-- 动态 props -->
  <ButtonIcon :icon="iconName" :tooltip="tooltipText" />
  
  <!-- 布尔 props -->
  <UserSelect multiple />
  <UserSelect :multiple="true" />
</template>
```

### 3. 事件监听

```vue
<template>
  <!-- 监听事件 -->
  <ButtonIcon @click="handleClick" />
  
  <!-- v-model 双向绑定 -->
  <DictSelect v-model="form.type" dict-type="sys_user_sex" />
</template>
```

### 4. 插槽使用

```vue
<template>
  <!-- 默认插槽 -->
  <DarkModeContainer>
    <div>内容</div>
  </DarkModeContainer>
  
  <!-- 具名插槽 -->
  <TableHeaderOperation>
    <template #extra>
      <el-button>自定义按钮</el-button>
    </template>
  </TableHeaderOperation>
</template>
```

### 5. 组件组合

```vue
<template>
  <el-card>
    <template #header>
      <TableHeaderOperation
        :loading="loading"
        @refresh="getData"
        @add="handleAdd"
      >
        <template #extra>
          <TableColumnSetting v-model:columns="columns" />
        </template>
      </TableHeaderOperation>
    </template>
    
    <el-table :data="data" :loading="loading">
      <!-- 表格列 -->
    </el-table>
  </el-card>
</template>
```

## 自定义组件开发

### 1. 组件模板

```vue
<script setup lang="ts">
import { ref, computed } from 'vue';

// 定义组件名称
defineOptions({
  name: 'CustomComponent'
});

// 定义 Props
interface Props {
  modelValue?: string;
  placeholder?: string;
  disabled?: boolean;
}

const props = withDefaults(defineProps<Props>(), {
  modelValue: '',
  placeholder: '请输入',
  disabled: false
});

// 定义 Emits
interface Emits {
  (e: 'update:modelValue', value: string): void;
  (e: 'change', value: string): void;
}

const emit = defineEmits<Emits>();

// 内部状态
const innerValue = computed({
  get: () => props.modelValue,
  set: (value) => {
    emit('update:modelValue', value);
    emit('change', value);
  }
});

// 方法
function handleClick() {
  // 处理逻辑
}
</script>

<template>
  <div class="custom-component">
    <el-input
      v-model="innerValue"
      :placeholder="placeholder"
      :disabled="disabled"
      @click="handleClick"
    />
  </div>
</template>

<style scoped lang="scss">
.custom-component {
  // 样式
}
</style>
```

### 2. 组件文档

为组件添加 JSDoc 注释：

```typescript
/**
 * 自定义组件
 * 
 * @example
 * ```vue
 * <CustomComponent v-model="value" placeholder="请输入" />
 * ```
 */
```

### 3. 组件测试

```typescript
import { mount } from '@vue/test-utils';
import CustomComponent from './custom-component.vue';

describe('CustomComponent', () => {
  it('renders properly', () => {
    const wrapper = mount(CustomComponent, {
      props: {
        modelValue: 'test'
      }
    });
    
    expect(wrapper.text()).toContain('test');
  });
});
```

## 组件库扩展

### 1. 添加新组件

```bash
# 1. 创建组件文件
touch src/components/custom/new-component.vue

# 2. 编写组件代码
# 3. 在需要的地方导入使用
```

### 2. 全局注册组件

```typescript
// src/main.ts
import NewComponent from '@/components/custom/new-component.vue';

app.component('NewComponent', NewComponent);
```

### 3. 自动导入组件

使用 `unplugin-vue-components` 自动导入组件：

```typescript
// vite.config.ts
import Components from 'unplugin-vue-components/vite';

export default {
  plugins: [
    Components({
      dirs: ['src/components'],
      dts: 'src/typings/components.d.ts'
    })
  ]
};
```

## 下一步

- 查看 [API 接口规范](./04-API接口规范.md)
- 学习 [工具函数库](./03-工具函数库.md)
- 阅读 [设计模式](./05-设计模式.md)
