# 菜单和功能结构文档

## 菜单层级树结构

### 完整菜单树

```
RuoYi-Plus-Soybean
├── 首页 (home)
│   └── 工作台 - 展示系统概览、统计数据、快捷入口
│
├── 系统管理 (system)
│   ├── 用户管理 (user)
│   │   ├── 查询用户列表
│   │   ├── 新增用户
│   │   ├── 编辑用户
│   │   ├── 删除用户
│   │   ├── 重置密码
│   │   ├── 导入用户
│   │   ├── 导出用户
│   │   └── 修改用户状态
│   │
│   ├── 角色管理 (role)
│   │   ├── 查询角色列表
│   │   ├── 新增角色
│   │   ├── 编辑角色
│   │   ├── 删除角色
│   │   ├── 配置权限
│   │   ├── 数据权限
│   │   └── 授权用户
│   │
│   ├── 菜单管理 (menu)
│   │   ├── 查询菜单列表
│   │   ├── 新增菜单
│   │   ├── 编辑菜单
│   │   ├── 删除菜单
│   │   └── 新增子菜单
│   │
│   ├── 部门管理 (dept)
│   │   ├── 查询部门列表
│   │   ├── 新增部门
│   │   ├── 编辑部门
│   │   └── 删除部门
│   │
│   ├── 岗位管理 (post)
│   │   ├── 查询岗位列表
│   │   ├── 新增岗位
│   │   ├── 编辑岗位
│   │   └── 删除岗位
│   │
│   ├── 字典管理 (dict)
│   │   ├── 查询字典类型列表
│   │   ├── 新增字典类型
│   │   ├── 编辑字典类型
│   │   ├── 删除字典类型
│   │   ├── 刷新字典缓存
│   │   ├── 导出字典类型
│   │   ├── 查询字典数据列表
│   │   ├── 新增字典数据
│   │   ├── 编辑字典数据
│   │   └── 删除字典数据
│
├── 系统监控 (monitor)
│   ├── 在线用户 (online)
│   │   ├── 查询在线用户列表
│   │   └── 强制退出
│   │
│   ├── 登录日志 (logininfor)
│   │   ├── 查询登录日志列表
│   │   ├── 删除登录日志
│   │   ├── 清空登录日志
│   │   └── 导出登录日志
│   │
│   ├── 操作日志 (operlog)
│   │   ├── 查询操作日志列表
│   │   ├── 删除操作日志
│   │   ├── 清空操作日志
│   │   └── 导出操作日志
│   │
│   └── 缓存监控 (cache)
│       ├── 查询缓存信息
│       └── 清理缓存
│
├── 系统工具 (tool)
│   └── 代码生成 (gen)
│       ├── 查询表列表
│       ├── 导入表
│       ├── 编辑表
│       ├── 删除表
│       ├── 预览代码
│       ├── 生成代码
│       └── 同步数据库
│
├── 示例页面 (demo)
│   ├── 示例演示 (demo)
│   └── 树形表格 (tree)
│
├── 关于 (about)
│   └── 关于系统 - 展示系统信息、版本信息、依赖信息
│
└── 内置页面 (_builtin)
    ├── 登录页面 (login)
    │   ├── 密码登录
    │   ├── 验证码登录
    │   ├── 用户注册
    │   ├── 重置密码
    │   └── 微信绑定
    ├── 用户中心 (user-center)
    ├── 403 页面 (403)
    ├── 404 页面 (404)
    ├── 500 页面 (500)
    ├── iframe 页面 (iframe-page)
    └── 社交登录回调 (social-callback)
```

## 页面路由映射表

### 系统管理模块

| 菜单名称 | 路由名称 | 路由路径 | 组件路径 | 权限标识 |
|---------|---------|---------|---------|---------|
| 用户管理 | system_user | /system/user | src/views/system/user/index.vue | system:user:list |
| 角色管理 | system_role | /system/role | src/views/system/role/index.vue | system:role:list |
| 菜单管理 | system_menu | /system/menu | src/views/system/menu/index.vue | system:menu:list |
| 部门管理 | system_dept | /system/dept | src/views/system/dept/index.vue | system:dept:list |
| 岗位管理 | system_post | /system/post | src/views/system/post/index.vue | system:post:list |
| 字典管理 | system_dict | /system/dict | src/views/system/dict/index.vue | system:dict:list |

### 系统监控模块

| 菜单名称 | 路由名称 | 路由路径 | 组件路径 | 权限标识 |
|---------|---------|---------|---------|---------|
| 在线用户 | monitor_online | /monitor/online | src/views/monitor/online/index.vue | monitor:online:list |
| 登录日志 | monitor_logininfor | /monitor/logininfor | src/views/monitor/logininfor/index.vue | monitor:logininfor:list |
| 操作日志 | monitor_operlog | /monitor/operlog | src/views/monitor/operlog/index.vue | monitor:operlog:list |
| 缓存监控 | monitor_cache | /monitor/cache | src/views/monitor/cache/index.vue | monitor:cache:list |

### 系统工具模块

| 菜单名称 | 路由名称 | 路由路径 | 组件路径 | 权限标识 |
|---------|---------|---------|---------|---------|
| 代码生成 | tool_gen | /tool/gen | src/views/tool/gen/index.vue | tool:gen:list |

### 其他页面

| 菜单名称 | 路由名称 | 路由路径 | 组件路径 | 权限标识 |
|---------|---------|---------|---------|---------|
| 首页 | home | /home | src/views/home/index.vue | - |
| 关于 | about | /about | src/views/about/index.vue | - |
| 用户中心 | user-center | /user-center | src/views/_builtin/user-center/index.vue | - |
| 登录 | login | /login | src/views/_builtin/login/index.vue | - |
| 403 | 403 | /403 | src/views/_builtin/403/index.vue | - |
| 404 | 404 | /404 | src/views/_builtin/404/index.vue | - |
| 500 | 500 | /500 | src/views/_builtin/500/index.vue | - |

## 功能权限矩阵

### 用户管理权限

| 功能 | 权限标识 | 说明 |
|-----|---------|------|
| 查询用户 | system:user:query | 查询用户列表 |
| 新增用户 | system:user:add | 新增用户信息 |
| 编辑用户 | system:user:edit | 编辑用户信息 |
| 删除用户 | system:user:remove | 删除用户 |
| 重置密码 | system:user:resetPwd | 重置用户密码 |
| 导入用户 | system:user:import | 批量导入用户 |
| 导出用户 | system:user:export | 导出用户数据 |
| 修改状态 | system:user:edit | 修改用户状态 |

### 角色管理权限

| 功能 | 权限标识 | 说明 |
|-----|---------|------|
| 查询角色 | system:role:query | 查询角色列表 |
| 新增角色 | system:role:add | 新增角色信息 |
| 编辑角色 | system:role:edit | 编辑角色信息 |
| 删除角色 | system:role:remove | 删除角色 |
| 配置权限 | system:role:edit | 配置角色菜单权限 |
| 数据权限 | system:role:edit | 配置角色数据权限 |
| 授权用户 | system:role:edit | 为角色授权用户 |

### 菜单管理权限

| 功能 | 权限标识 | 说明 |
|-----|---------|------|
| 查询菜单 | system:menu:query | 查询菜单列表 |
| 新增菜单 | system:menu:add | 新增菜单信息 |
| 编辑菜单 | system:menu:edit | 编辑菜单信息 |
| 删除菜单 | system:menu:remove | 删除菜单 |

### 部门管理权限

| 功能 | 权限标识 | 说明 |
|-----|---------|------|
| 查询部门 | system:dept:query | 查询部门列表 |
| 新增部门 | system:dept:add | 新增部门信息 |
| 编辑部门 | system:dept:edit | 编辑部门信息 |
| 删除部门 | system:dept:remove | 删除部门 |

### 岗位管理权限

| 功能 | 权限标识 | 说明 |
|-----|---------|------|
| 查询岗位 | system:post:query | 查询岗位列表 |
| 新增岗位 | system:post:add | 新增岗位信息 |
| 编辑岗位 | system:post:edit | 编辑岗位信息 |
| 删除岗位 | system:post:remove | 删除岗位 |
| 导出岗位 | system:post:export | 导出岗位数据 |

### 字典管理权限

| 功能 | 权限标识 | 说明 |
|-----|---------|------|
| 查询字典 | system:dict:query | 查询字典列表 |
| 新增字典 | system:dict:add | 新增字典信息 |
| 编辑字典 | system:dict:edit | 编辑字典信息 |
| 删除字典 | system:dict:remove | 删除字典 |
| 导出字典 | system:dict:export | 导出字典数据 |
| 刷新缓存 | system:dict:remove | 刷新字典缓存 |

### 系统监控权限

| 功能 | 权限标识 | 说明 |
|-----|---------|------|
| 在线用户查询 | monitor:online:query | 查询在线用户 |
| 强制退出 | monitor:online:forceLogout | 强制用户退出 |
| 登录日志查询 | monitor:logininfor:query | 查询登录日志 |
| 登录日志删除 | monitor:logininfor:remove | 删除登录日志 |
| 登录日志导出 | monitor:logininfor:export | 导出登录日志 |
| 操作日志查询 | monitor:operlog:query | 查询操作日志 |
| 操作日志删除 | monitor:operlog:remove | 删除操作日志 |
| 操作日志导出 | monitor:operlog:export | 导出操作日志 |
| 缓存监控查询 | monitor:cache:query | 查询缓存信息 |
| 缓存清理 | monitor:cache:remove | 清理缓存 |

### 代码生成权限

| 功能 | 权限标识 | 说明 |
|-----|---------|------|
| 查询表 | tool:gen:query | 查询数据表 |
| 导入表 | tool:gen:import | 导入数据表 |
| 编辑表 | tool:gen:edit | 编辑表配置 |
| 删除表 | tool:gen:remove | 删除表配置 |
| 预览代码 | tool:gen:preview | 预览生成代码 |
| 生成代码 | tool:gen:code | 生成代码 |

## 路由配置说明

### 路由元信息 (meta)

```typescript
interface RouteMeta {
  /** 路由标题 */
  title: string;
  /** 国际化 key */
  i18nKey?: string;
  /** 路由图标 (iconify) */
  icon?: string;
  /** 本地图标 */
  localIcon?: string;
  /** 路由排序 */
  order?: number;
  /** 是否为常量路由（不需要权限） */
  constant?: boolean;
  /** 是否在菜单中隐藏 */
  hideInMenu?: boolean;
  /** 是否缓存页面 */
  keepAlive?: boolean;
  /** 外部链接 */
  href?: string;
  /** 是否为多级路由的中间级 */
  multi?: boolean;
}
```

### 路由类型

#### 1. 常量路由 (Constant Route)
不需要权限验证的路由，如登录页、404 页面等。

```typescript
{
  name: 'login',
  path: '/login',
  component: 'layout.blank$view.login',
  meta: {
    title: 'login',
    constant: true,
    hideInMenu: true
  }
}
```

#### 2. 权限路由 (Auth Route)
需要权限验证的路由，根据用户角色动态加载。

```typescript
{
  name: 'system_user',
  path: '/system/user',
  component: 'view.system_user',
  meta: {
    title: 'system_user',
    i18nKey: 'route.system_user'
  }
}
```

#### 3. 外部链接路由
跳转到外部链接的路由。

```typescript
{
  name: 'external-link',
  path: '/external-link',
  meta: {
    title: 'external-link',
    href: 'https://example.com'
  }
}
```

#### 4. iframe 路由
在 iframe 中显示外部页面的路由。

```typescript
{
  name: 'iframe-page',
  path: '/iframe-page/:url',
  component: 'layout.base$view.iframe-page',
  meta: {
    title: 'iframe-page',
    keepAlive: true
  }
}
```

## 菜单配置说明

### 菜单类型

1. **目录 (M)**: 包含子菜单的目录
2. **菜单 (C)**: 具体的页面菜单
3. **按钮 (F)**: 页面内的操作按钮

### 菜单图标类型

1. **Iconify 图标**: 使用 iconify 图标库
2. **本地图标**: 使用项目内的 SVG 图标

### 菜单布局类型

1. **默认布局 (0)**: 使用系统默认布局
2. **空白布局 (1)**: 使用空白布局（无侧边栏、无头部）

### 菜单显示状态

1. **显示 (0)**: 在菜单中显示
2. **隐藏 (1)**: 在菜单中隐藏

### 菜单状态

1. **正常 (0)**: 菜单可用
2. **停用 (1)**: 菜单不可用

## 权限控制流程

### 1. 路由权限控制

```
用户登录 → 获取用户信息 → 获取用户权限 → 生成动态路由 → 添加到路由表
```

### 2. 菜单权限控制

```
获取用户权限 → 过滤菜单列表 → 生成菜单树 → 渲染菜单
```

### 3. 按钮权限控制

```
获取用户权限 → 检查按钮权限 → 显示/隐藏按钮
```

## 权限指令使用

### v-hasPermi 指令
用于控制按钮的显示和隐藏。

```vue
<template>
  <!-- 单个权限 -->
  <el-button v-hasPermi="['system:user:add']">新增</el-button>
  
  <!-- 多个权限（满足其一即可） -->
  <el-button v-hasPermi="['system:user:edit', 'system:user:add']">编辑</el-button>
</template>
```

### v-hasRole 指令
用于控制基于角色的显示和隐藏。

```vue
<template>
  <!-- 单个角色 -->
  <el-button v-hasRole="['admin']">管理员操作</el-button>
  
  <!-- 多个角色（满足其一即可） -->
  <el-button v-hasRole="['admin', 'common']">操作</el-button>
</template>
```

## 动态路由加载流程

```
1. 用户登录成功
   ↓
2. 获取用户信息和权限
   ↓
3. 根据权限过滤路由
   ↓
4. 转换为 Vue Router 路由格式
   ↓
5. 动态添加到路由表
   ↓
6. 生成菜单树
   ↓
7. 渲染菜单和页面
```

## 路由缓存策略

### 1. 标签页缓存
- 通过 `keepAlive` 控制页面是否缓存
- 关闭标签页时清除缓存
- 刷新标签页时重新加载

### 2. 路由缓存配置

```typescript
{
  name: 'system_user',
  path: '/system/user',
  component: 'view.system_user',
  meta: {
    title: 'system_user',
    keepAlive: true  // 开启缓存
  }
}
```

## 面包屑导航

面包屑导航自动根据当前路由生成，显示当前页面的层级关系。

```
首页 > 系统管理 > 用户管理
```

配置项：
- `visible`: 是否显示面包屑
- `showIcon`: 是否显示图标
