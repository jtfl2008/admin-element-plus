# 系统架构概述

## 项目简介

RuoYi-Plus-Soybean 是一个现代化的企业级多租户管理系统，结合了 RuoYi-Vue-Plus 的强大后端功能和 Soybean Admin 的现代化前端特性，为开发者提供了完整的企业管理解决方案。

## 核心特性

### 1. 多租户架构
- 完整支持 SaaS 多租户模式
- 灵活的租户管理能力
- 租户数据隔离

### 2. 现代化技术栈
- **前端**: Vue 3.5 + TypeScript 5.9 + Vite 7.2
- **UI 组件**: Element Plus 2.13
- **状态管理**: Pinia 3.0
- **路由管理**: Vue Router 4.6
- **HTTP 客户端**: Axios/Alova
- **CSS 预处理器**: SCSS/Sass
- **包管理**: pnpm Monorepo

### 3. Monorepo 工程管理
- 使用 pnpm workspaces 管理多包结构
- 模块化设计，便于维护和扩展
- 代码复用性高

### 4. 丰富的功能特性
- 多种布局模式（垂直、水平、混合等）
- 可配置的主题系统（明暗模式、主题色定制）
- 标签页管理（多种标签风格、右键菜单）
- 国际化支持（中文、英文）
- 精细的权限控制（菜单和按钮级别）

## 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                         前端应用层                            │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              Vue 3 + TypeScript 应用                  │   │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐     │   │
│  │  │  视图层     │  │  组件层     │  │  布局层     │     │   │
│  │  │  (Views)   │  │(Components)│  │ (Layouts)  │     │   │
│  │  └────────────┘  └────────────┘  └────────────┘     │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                        业务逻辑层                             │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐     │   │
│  │  │ 状态管理    │  │  路由管理   │  │  权限控制   │     │   │
│  │  │  (Pinia)   │  │(Vue Router)│  │   (Auth)   │     │   │
│  │  └────────────┘  └────────────┘  └────────────┘     │   │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐     │   │
│  │  │  主题管理   │  │  字典管理   │  │  通知管理   │     │   │
│  │  │  (Theme)   │  │   (Dict)   │  │  (Notice)  │     │   │
│  │  └────────────┘  └────────────┘  └────────────┘     │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                        数据服务层                             │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐     │   │
│  │  │ HTTP 客户端 │  │  API 服务   │  │  数据转换   │     │   │
│  │  │(Axios/Alova)│ │  (Service) │  │ (Transform)│     │   │
│  │  └────────────┘  └────────────┘  └────────────┘     │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                      Monorepo 包层                           │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  @sa/hooks  │  @sa/utils  │  @sa/materials           │   │
│  │  @sa/axios  │  @sa/color  │  @sa/scripts             │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                        后端服务层                             │
│  ┌──────────────────────────────────────────────────────┐   │
│  │         RuoYi-Vue-Plus 后端服务                       │   │
│  │  Spring Boot + MyBatis-Plus + Sa-Token               │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                        数据存储层                             │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  MySQL  │  Redis  │  OSS 对象存储                     │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

## 分层设计说明

### 1. 前端应用层
负责用户界面的展示和交互，包括：
- **视图层 (Views)**: 页面组件，对应具体的业务功能
- **组件层 (Components)**: 可复用的 UI 组件
- **布局层 (Layouts)**: 页面布局模板

### 2. 业务逻辑层
处理应用的业务逻辑，包括：
- **状态管理**: 使用 Pinia 管理全局状态
- **路由管理**: 使用 Vue Router 管理页面路由
- **权限控制**: 基于角色的权限控制系统
- **主题管理**: 主题配置和切换
- **字典管理**: 数据字典缓存和管理
- **通知管理**: 系统通知和消息管理

### 3. 数据服务层
负责与后端 API 的交互，包括：
- **HTTP 客户端**: 封装的 Axios/Alova 请求库
- **API 服务**: 统一的 API 接口定义
- **数据转换**: 请求和响应数据的转换处理

### 4. Monorepo 包层
提供可复用的工具和组件库，包括：
- **@sa/hooks**: Vue 组合函数库
- **@sa/utils**: 通用工具函数库
- **@sa/materials**: UI 组件和材料库
- **@sa/axios**: HTTP 客户端封装
- **@sa/color**: 颜色管理工具
- **@sa/scripts**: 构建和开发脚本

### 5. 后端服务层
基于 RuoYi-Vue-Plus 的后端服务，提供：
- RESTful API 接口
- 用户认证和授权
- 业务逻辑处理
- 数据持久化

### 6. 数据存储层
数据存储和缓存，包括：
- **MySQL**: 关系型数据库
- **Redis**: 缓存和会话存储
- **OSS**: 对象存储服务

## 技术栈详细说明

### 前端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| Vue | 3.5.25 | 核心框架 |
| TypeScript | 5.9.3 | 开发语言 |
| Vite | 7.2.6 | 构建工具 |
| Element Plus | 2.13.0 | UI 组件库 |
| Pinia | 3.0.4 | 状态管理 |
| Vue Router | 4.6.3 | 路由管理 |
| Axios | 1.13.2 | HTTP 客户端 |
| Sass | 最新版 | CSS 预处理器 |
| Vue I18n | 11.2.2 | 国际化 |
| Dayjs | 1.11.19 | 日期处理 |
| ECharts | 6.0.0 | 图表库 |
| NProgress | 0.2.0 | 进度条 |

### 后端技术栈（兼容 RuoYi-Vue-Plus）

| 技术 | 用途 |
|------|------|
| Spring Boot | 核心框架 |
| Spring Security | 安全框架 |
| Sa-Token | 权限认证 |
| MyBatis-Plus | ORM 框架 |
| MySQL | 数据库 |
| Redis | 缓存 |

## 部署架构

### 开发环境
```
开发者本地 → Vite Dev Server (端口 9527) → 后端 API (代理)
```

### 生产环境
```
用户浏览器 → Nginx (静态资源) → 后端 API 服务器 → MySQL/Redis
```

## 运行环境要求

### 开发环境
- Node.js >= 20.19.0
- pnpm >= 10.5.0
- Git

### 生产环境
- Nginx (推荐)
- Node.js (如需 SSR)
- 后端服务器（Java 环境）
- MySQL 数据库
- Redis 缓存服务

## 模块职责划分

### 核心模块

#### 1. 认证模块 (Auth)
- 用户登录/登出
- Token 管理
- 用户信息获取
- 权限验证

#### 2. 路由模块 (Route)
- 动态路由生成
- 路由权限控制
- 菜单生成
- 面包屑导航

#### 3. 主题模块 (Theme)
- 主题配置管理
- 明暗模式切换
- 主题色定制
- 布局模式切换

#### 4. 标签页模块 (Tab)
- 标签页管理
- 标签页缓存
- 标签页操作（关闭、刷新等）

#### 5. 字典模块 (Dict)
- 字典数据缓存
- 字典数据获取
- 字典数据刷新

#### 6. 通知模块 (Notice)
- 系统通知管理
- 消息推送
- 通知状态管理

### 业务模块

#### 1. 系统管理
- 用户管理
- 角色管理
- 菜单管理
- 部门管理
- 岗位管理
- 字典管理

#### 2. 系统监控
- 在线用户
- 登录日志
- 操作日志
- 缓存监控

#### 3. 开发工具
- 代码生成

## 模块间依赖关系

```
┌─────────────────────────────────────────────────────────┐
│                      应用入口 (main.ts)                   │
└─────────────────────────────────────────────────────────┘
                            ↓
        ┌───────────────────┼───────────────────┐
        ↓                   ↓                   ↓
┌───────────────┐  ┌───────────────┐  ┌───────────────┐
│  Store (Pinia)│  │ Router (VR)   │  │  I18n (VI18n) │
└───────────────┘  └───────────────┘  └───────────────┘
        ↓                   ↓                   ↓
┌─────────────────────────────────────────────────────────┐
│                      核心模块层                           │
│  Auth  │  Route  │  Theme  │  Tab  │  Dict  │  Notice  │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│                      服务层 (Service)                     │
│  API 接口  │  HTTP 客户端  │  数据转换                    │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│                   Monorepo 包层                          │
│  @sa/hooks  │  @sa/utils  │  @sa/materials  │  ...      │
└─────────────────────────────────────────────────────────┘
```

### 依赖说明

1. **应用入口依赖**
   - Store (Pinia): 状态管理
   - Router (Vue Router): 路由管理
   - I18n (Vue I18n): 国际化

2. **核心模块依赖**
   - Auth 模块依赖: Route、Tab、Notice
   - Route 模块依赖: Auth
   - Theme 模块: 独立模块
   - Tab 模块依赖: Route
   - Dict 模块: 独立模块
   - Notice 模块: 独立模块

3. **服务层依赖**
   - 依赖 Monorepo 包层的工具函数
   - 被核心模块层调用

4. **Monorepo 包层**
   - 提供基础工具和组件
   - 被所有上层模块使用

## 数据流向

### 用户操作流程
```
用户操作 → 视图层 → 业务逻辑层 → 数据服务层 → 后端 API
                                              ↓
用户界面 ← 视图层 ← 业务逻辑层 ← 数据服务层 ← 后端响应
```

### 状态管理流程
```
组件 → Action → Mutation → State → Getter → 组件
```

### 路由守卫流程
```
路由跳转 → 进度条开始 → 权限验证 → 动态路由加载 → 页面渲染 → 进度条结束
```

## 安全机制

### 1. 认证机制
- JWT Token 认证
- Token 自动刷新
- Token 过期处理

### 2. 权限控制
- 路由级权限控制
- 菜单级权限控制
- 按钮级权限控制
- 数据权限控制

### 3. 数据安全
- 密码加密传输（RSA）
- XSS 防护
- CSRF 防护
- SQL 注入防护

## 性能优化

### 1. 构建优化
- Vite 快速构建
- 代码分割
- Tree Shaking
- 资源压缩

### 2. 运行时优化
- 路由懒加载
- 组件懒加载
- 图片懒加载
- 虚拟滚动

### 3. 缓存策略
- 路由缓存
- 标签页缓存
- 字典数据缓存
- HTTP 请求缓存

## 扩展性设计

### 1. 插件化架构
- Vite 插件系统
- Vue 插件系统
- 自定义插件扩展

### 2. 主题定制
- CSS 变量系统
- SCSS 样式预处理
- 主题配置文件
- 动态主题切换

### 3. 国际化
- 多语言支持
- 动态语言切换
- 语言包扩展

### 4. 组件扩展
- 自定义组件
- 组件库扩展
- 业务组件封装
